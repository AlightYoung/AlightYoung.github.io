(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{495:function(s,t,a){"use strict";a.r(t);var e=a(2),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#_1-数据库相关概念"}},[s._v("1. 数据库相关概念")])]),t("li",[t("a",{attrs:{href:"#_2-mysql概念及安装"}},[s._v("2. MySQL概念及安装")])]),t("li",[t("a",{attrs:{href:"#_3-基本关键字"}},[s._v("3. 基本关键字")]),t("ul",[t("li",[t("a",{attrs:{href:"#_3-1-select"}},[s._v("3.1 select")])]),t("li",[t("a",{attrs:{href:"#_3-2-distinct"}},[s._v("3.2 distinct")])]),t("li",[t("a",{attrs:{href:"#_3-3-limit"}},[s._v("3.3 limit")])]),t("li",[t("a",{attrs:{href:"#_3-4-order-by"}},[s._v("3.4 order by")])]),t("li",[t("a",{attrs:{href:"#_3-5-where"}},[s._v("3.5 where")])]),t("li",[t("a",{attrs:{href:"#_3-6-not"}},[s._v("3.6 not")])]),t("li",[t("a",{attrs:{href:"#_3-7-between"}},[s._v("3.7 between")])]),t("li",[t("a",{attrs:{href:"#_3-8-in"}},[s._v("3.8 in")])]),t("li",[t("a",{attrs:{href:"#_3-9-and"}},[s._v("3.9 and")])]),t("li",[t("a",{attrs:{href:"#_3-10-or"}},[s._v("3.10 or")])]),t("li",[t("a",{attrs:{href:"#_3-11-like"}},[s._v("3.11 like")])]),t("li",[t("a",{attrs:{href:"#_3-12-regexp"}},[s._v("3.12 regexp")])]),t("li",[t("a",{attrs:{href:"#_3-13-as"}},[s._v("3.13 as")])]),t("li",[t("a",{attrs:{href:"#_3-14-group-by"}},[s._v("3.14 group by")])]),t("li",[t("a",{attrs:{href:"#_3-15-having"}},[s._v("3.15 having")])]),t("li",[t("a",{attrs:{href:"#_3-16-insert"}},[s._v("3.16 insert")])]),t("li",[t("a",{attrs:{href:"#_3-17-update"}},[s._v("3.17 update")])]),t("li",[t("a",{attrs:{href:"#_3-18-delete"}},[s._v("3.18 delete")])])])]),t("li",[t("a",{attrs:{href:"#_4-函数和运算符"}},[s._v("4. 函数和运算符")]),t("ul",[t("li",[t("a",{attrs:{href:"#_4-1-运算符"}},[s._v("4.1 运算符")])]),t("li",[t("a",{attrs:{href:"#_4-2-函数"}},[s._v("4.2 函数")])])])]),t("li",[t("a",{attrs:{href:"#_5-高级部分"}},[s._v("5. 高级部分")]),t("ul",[t("li",[t("a",{attrs:{href:"#_5-1-子查询-subquery"}},[s._v("5.1 子查询（subquery）")])]),t("li",[t("a",{attrs:{href:"#_5-2-连表查询-join"}},[s._v("5.2 连表查询（join）")])]),t("li",[t("a",{attrs:{href:"#_5-3-组合查询-union"}},[s._v("5.3 组合查询（union）")])]),t("li",[t("a",{attrs:{href:"#_5-4-全文索引-fulltext-index"}},[s._v("5.4 全文索引（fulltext index）")])]),t("li",[t("a",{attrs:{href:"#_5-5-视图-view"}},[s._v("5.5 视图（view）")])]),t("li",[t("a",{attrs:{href:"#_5-6-存储过程-stored-procedure"}},[s._v("5.6 存储过程（Stored Procedure）")])]),t("li",[t("a",{attrs:{href:"#_5-7-游标-cursor"}},[s._v("5.7 游标（cursor）")])]),t("li",[t("a",{attrs:{href:"#_5-8-触发器-trigger"}},[s._v("5.8 触发器（trigger）")])]),t("li",[t("a",{attrs:{href:"#_5-9-事务-transaction"}},[s._v("5.9 事务（transaction）")])])])]),t("li",[t("a",{attrs:{href:"#_6-一些提示与建议"}},[s._v("6. 一些提示与建议")]),t("ul",[t("li",[t("a",{attrs:{href:"#_6-1-select语句的关键字顺序"}},[s._v("6.1 select语句的关键字顺序")])])])]),t("li",[t("a",{attrs:{href:"#_7-常见sql语句"}},[s._v("7. 常见SQL语句")]),t("ul",[t("li",[t("a",{attrs:{href:"#_7-1-数据库相关"}},[s._v("7.1 数据库相关")])]),t("li",[t("a",{attrs:{href:"#_7-2-表相关"}},[s._v("7.2 表相关")])]),t("li",[t("a",{attrs:{href:"#_7-3-用户权限相关"}},[s._v("7.3 用户权限相关")])]),t("li",[t("a",{attrs:{href:"#_7-4-字符集相关"}},[s._v("7.4 字符集相关")])])])])])]),t("p"),s._v(" "),t("h2",{attrs:{id:"_1-数据库相关概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-数据库相关概念"}},[s._v("#")]),s._v(" 1. 数据库相关概念")]),s._v(" "),t("p",[t("strong",[s._v("数据库（Database）")]),s._v("：Database是按照数据结构来组织、存储和管理数据的仓库。")]),s._v(" "),t("p",[t("strong",[s._v("数据库管理系统（Database Management System）")]),s._v("：数据库管理系统是一种操纵和管理数据库的大型软件，用于建立、使用和维护数据库，简称DBMS。DBMS可分为"),t("strong",[s._v("关系型数据库管理系统")]),s._v("（Relational Database Management System：RDBMS）与"),t("strong",[s._v("NoSQL")]),s._v("（Not only SQL：对不同于传统的关系数据库的数据库管理系统的统称）。")]),s._v(" "),t("p",[t("strong",[s._v("数据库系统（Database System）")]),s._v("：数据库系统，是由数据库及其管理软件组成的系统。")]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("p",[s._v("现实中可能会经常听到一些人使用“数据库”（Database）来表示“数据库管理系统”（Database Managment System）这一概念，但其实这是两个不同的概念，只是被简化了，例如我们通常使用“法人”表示“法人代表”，但其实“法人”表示的是组织。")])]),t("p",[t("strong",[s._v("模式（schema）")]),s._v("：关于数据库和表的布局及特性的信息。")]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("p",[s._v("在某些时候，schema也可用于表示数据库。")])]),t("p",[t("strong",[s._v("表（table）")]),s._v("：数据库中的特定类型数据的结构化清单。")]),s._v(" "),t("p",[t("strong",[s._v("列（column）")]),s._v("：表中的一个字段。所有表都是由一个或多个列组成的。")]),s._v(" "),t("p",[t("strong",[s._v("行（row）")]),s._v("：表中的数据是按行存储的，所保存的每个记录存储在自己的行内。有时也称为记录（record）。")]),s._v(" "),t("p",[t("strong",[s._v("数据类型（datatype）")]),s._v("：每一列都可以根据自身的特性选择特定的数据类型。")]),s._v(" "),t("p",[t("strong",[s._v("主键（primary key）")]),s._v("：通常用于确定唯一的行，所以主键是不能重复的。")]),s._v(" "),t("p",[t("strong",[s._v("外键（foreign key）")]),s._v("：表中存储的与其他表主键关联的键，叫外键。")]),s._v(" "),t("p",[t("strong",[s._v("索引（index）")]),s._v("：相当于对列添加目录，用于加速列的查询。")]),s._v(" "),t("p",[t("strong",[s._v("SQL")]),s._v("：结构化查询语言（Structured Query Language）的缩写。用于与数据库通信。")]),s._v(" "),t("h2",{attrs:{id:"_2-mysql概念及安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-mysql概念及安装"}},[s._v("#")]),s._v(" 2. MySQL概念及安装")]),s._v(" "),t("p",[s._v("MySQL是一个关系型数据库管理系统，由瑞典MySQL AB 公司开发，目前属于 Oracle 旗下产品。因为其开源的特性所以成为了当下较为流行的DBMS。目前为止MySQL已经更新到了8这个大版本，也算是久经沙场了。")]),s._v(" "),t("p",[s._v("对于初学者来说，你可以使用MySQL自带的命令行工具来学习MySQL，也可以使用第三方MySQL管理软件，例如开源的"),t("a",{attrs:{href:"https://dbeaver.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Dbeaver"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("p",[s._v("MySQL官方网站："),t("a",{attrs:{href:"https://www.mysql.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.mysql.com/"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("直接下载MySQL社区服务端："),t("a",{attrs:{href:"https://dev.mysql.com/downloads/mysql/",target:"_blank",rel:"noopener noreferrer"}},[s._v("MySQL Community Server Download"),t("OutboundLink")],1),s._v("，根据自己需求下载压缩包或者是MSI安装程序，新手建议选择MSI安装程序。")]),s._v(" "),t("p",[s._v("下载完成之后双击安装程序即可，过程选项看着选，看不懂就翻译，这里不多赘述。")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/",target:"_blank",rel:"noopener noreferrer"}},[s._v("MySQL 8.0参考手册"),t("OutboundLink")],1),s._v("，下载安装等相关指南都在里面了，如果只是下载和入门只需要过一下"),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/installing.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Installing and Upgrading MySQL"),t("OutboundLink")],1),s._v("和"),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/tutorial.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Tutorial"),t("OutboundLink")],1),s._v("这两个篇章就行了（看着吃力就翻译）。")]),s._v(" "),t("p",[s._v("安装完成之后，尝试使用 "),t("code",[s._v("mysql -u root -p")]),s._v(" ，根据提示输入密码即可连接到本地MySQL服务端。")]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("p",[s._v("提示没有mysql这个指令则需要将mysql安装目录下的bin目录添加到环境变量即可")])]),t("p",[s._v("登录之后可以 "),t("code",[s._v("show databases;")]),s._v(" 查看所有数据库，"),t("code",[s._v("use {database_name}")]),s._v(" 切换数据库，"),t("code",[s._v("show tables;")]),s._v("查看当前数据库下的所有表，"),t("code",[s._v("describe {table_name};")]),s._v("查看表结构等。("),t("em",[s._v("大括号里替代成具体的数据库/表的名称")]),s._v(")")]),s._v(" "),t("h2",{attrs:{id:"_3-基本关键字"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-基本关键字"}},[s._v("#")]),s._v(" 3. 基本关键字")]),s._v(" "),t("p",[s._v("以下均使用"),t("code",[s._v("table")]),s._v("代替表名，"),t("code",[s._v("column")]),s._v("代替列名。")]),s._v(" "),t("h3",{attrs:{id:"_3-1-select"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-select"}},[s._v("#")]),s._v(" 3.1 select")]),s._v(" "),t("p",[s._v("用于查询数据。")]),s._v(" "),t("p",[s._v("常见用法：")]),s._v(" "),t("ol",[t("li",[s._v("查询全部数据："),t("code",[s._v("select * from table;")])]),s._v(" "),t("li",[s._v("查询单/多列："),t("code",[s._v("select column/column1,column2 from table;")])])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("在使用列名是可以使用"),t("strong",[s._v("表名.列名")]),s._v("的写法，例如"),t("code",[s._v("select table.column from table;")]),s._v("，这在之后的联表查询会经常使用。")])]),t("h3",{attrs:{id:"_3-2-distinct"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-distinct"}},[s._v("#")]),s._v(" 3.2 distinct")]),s._v(" "),t("p",[s._v("用于剔除结果中的重复数据。")]),s._v(" "),t("p",[s._v("常见用法：")]),s._v(" "),t("ol",[t("li",[s._v("查询去重："),t("code",[s._v("select distinct column from table;")])])]),s._v(" "),t("h3",{attrs:{id:"_3-3-limit"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-limit"}},[s._v("#")]),s._v(" 3.3 limit")]),s._v(" "),t("p",[s._v("限制结果集。不指定正反则默认为正序，即按照"),t("code",[s._v("asc")]),s._v("方式进行排序.")]),s._v(" "),t("p",[s._v("常见用法：")]),s._v(" "),t("ol",[t("li",[s._v("限制为1条记录："),t("code",[s._v("select * from table limit 1;")])]),s._v(" "),t("li",[s._v("偏移限制-写法1："),t("code",[s._v("select * from table limit 2 , 3;")])]),s._v(" "),t("li",[s._v("偏移限制-写法1: "),t("code",[s._v("select * from table limit 3 offset 2;")])])]),s._v(" "),t("p",[s._v("以上两种写法都代表从第二条记录后取3条数据，即(3,4,5)")]),s._v(" "),t("h3",{attrs:{id:"_3-4-order-by"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-order-by"}},[s._v("#")]),s._v(" 3.4 order by")]),s._v(" "),t("p",[s._v("用于对数据排序。")]),s._v(" "),t("p",[s._v("常见用法：")]),s._v(" "),t("ol",[t("li",[s._v("正序排序1："),t("code",[s._v("select * from table order by column;")])]),s._v(" "),t("li",[s._v("正序排序2: "),t("code",[s._v("select * from table order by column asc;")])]),s._v(" "),t("li",[s._v("倒序排序："),t("code",[s._v("select * from table order by column desc;")])]),s._v(" "),t("li",[s._v("多列排序："),t("code",[s._v("select * from table order by column1 asc,column2 desc;")])])]),s._v(" "),t("h3",{attrs:{id:"_3-5-where"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-where"}},[s._v("#")]),s._v(" 3.5 where")]),s._v(" "),t("p",[s._v("用于对数据的过滤，其后可以接子句等其他表达式。")]),s._v(" "),t("p",[s._v("常见用法：")]),s._v(" "),t("ol",[t("li",[s._v("查询列值为1的记录："),t("code",[s._v("select * from table where column = 1;")])]),s._v(" "),t("li",[s._v("查询列值为Null的记录："),t("code",[s._v("select * from table where column is null;")])])]),s._v(" "),t("p",[s._v("在上述示例中我们只使用了“＝”这个比较符号，在MySQL中还有这些比较符号可以在where语句中使用。")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",{staticStyle:{"text-align":"center"}},[s._v("符号")]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[s._v("含义")])])]),s._v(" "),t("tbody",[t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("=")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("等于")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("<>")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("不等于")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("!=")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("不等于")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("<")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("小于")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("<=")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("小于等于")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v(">")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("大于")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v(">=")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("大于等于")])])])]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("p",[s._v("注意：null是这个列没有被赋值，而不是空字符串或者空格，也不是0。")])]),t("h3",{attrs:{id:"_3-6-not"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-not"}},[s._v("#")]),s._v(" 3.6 not")]),s._v(" "),t("p",[s._v("常用于对逻辑取反。例如与"),t("code",[s._v("between")]),s._v("与"),t("code",[s._v("in")]),s._v("的取反。")]),s._v(" "),t("h3",{attrs:{id:"_3-7-between"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-between"}},[s._v("#")]),s._v(" 3.7 between")]),s._v(" "),t("p",[s._v("常用于与where配合限制数据在某个区间内。")]),s._v(" "),t("p",[s._v("常见用法：")]),s._v(" "),t("ol",[t("li",[s._v("查询列值在1到10之间的记录："),t("code",[s._v("select * from table where column between 1 and 10;")])]),s._v(" "),t("li",[s._v("查询列值不在1到10之间的记录："),t("code",[s._v("select * from table where column not between 1 and 10;")])])]),s._v(" "),t("h3",{attrs:{id:"_3-8-in"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-in"}},[s._v("#")]),s._v(" 3.8 in")]),s._v(" "),t("p",[s._v("常用于配合where语法，对数据进行结果集过滤。")]),s._v(" "),t("p",[s._v("常见用法：")]),s._v(" "),t("ol",[t("li",[s._v("查询列值在某个结果集的记录："),t("code",[s._v("select * from table where column in (1,2);")])]),s._v(" "),t("li",[s._v("查询列值不在某个结果集的记录："),t("code",[s._v("select * from table where column not in (1,2);")])])]),s._v(" "),t("h3",{attrs:{id:"_3-9-and"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-9-and"}},[s._v("#")]),s._v(" 3.9 and")]),s._v(" "),t("p",[s._v("常用于与where语句配合，进行多条件的逻辑与判断")]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("p",[t("code",[s._v("and")]),s._v("与"),t("code",[s._v("or")]),s._v("同时使用"),t("code",[s._v("and")]),s._v("拥有更多的优先级，当同时使用时，推荐使用括号来明确优先级。")])]),t("p",[s._v("常见用法：")]),s._v(" "),t("ol",[t("li",[s._v("限制多属性查询："),t("code",[s._v("select * from table where column1 = 1 and column2 = '计算机';")])])]),s._v(" "),t("h3",{attrs:{id:"_3-10-or"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-10-or"}},[s._v("#")]),s._v(" 3.10 or")]),s._v(" "),t("p",[s._v("常用于与where语句配合，进行多条件的逻辑或判断")]),s._v(" "),t("p",[s._v("常见用法：")]),s._v(" "),t("ol",[t("li",[s._v("限制单属性多选择："),t("code",[s._v("select * from table where column = 1 or column = 2;")])]),s._v(" "),t("li",[s._v("等上写法："),t("code",[s._v("select * from table where column in (1,2);")])]),s._v(" "),t("li",[s._v("等上写法："),t("code",[s._v("select * from table where column between 1 and 2;")])])]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("p",[t("code",[s._v("and")]),s._v("与"),t("code",[s._v("or")]),s._v("同时使用"),t("code",[s._v("and")]),s._v("拥有更多的优先级，当同时使用时，推荐使用括号来明确优先级。")])]),t("h3",{attrs:{id:"_3-11-like"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-11-like"}},[s._v("#")]),s._v(" 3.11 like")]),s._v(" "),t("p",[s._v("用于模糊匹配，常与"),t("code",[s._v("%")]),s._v("一起使用。")]),s._v(" "),t("p",[s._v("另一个通配符是"),t("code",[s._v("_")]),s._v("，和"),t("code",[s._v("%")]),s._v("不同的是，"),t("code",[s._v("_")]),s._v("只能匹配单个字符。")]),s._v(" "),t("p",[s._v("常见用法：")]),s._v(" "),t("ol",[t("li",[s._v("左模糊："),t("code",[s._v("select * from table where column like '1%';")])]),s._v(" "),t("li",[s._v("右模糊："),t("code",[s._v("select * from table where column like '%1';")])]),s._v(" "),t("li",[s._v("中间模糊："),t("code",[s._v("select * from table where column like '1%1';")])]),s._v(" "),t("li",[s._v("左右模糊："),t("code",[s._v("select * from table where column like '%1%';")])])]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("p",[s._v("模糊查询效率相对较低，如果可以简单查询的话，尽量使用简单明确的条件过滤。")])]),t("h3",{attrs:{id:"_3-12-regexp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-12-regexp"}},[s._v("#")]),s._v(" 3.12 regexp")]),s._v(" "),t("p",[s._v("用于进行正则表达式过滤。")]),s._v(" "),t("p",[s._v("常见用法：")]),s._v(" "),t("ol",[t("li",[s._v("查询包含1的结果集："),t("code",[s._v("select * from table where column regexp '1';")])]),s._v(" "),t("li",[s._v("查询包含"),t("code",[s._v("1%")]),s._v("的结果集：`select * from table where column regexp '1.'")])]),s._v(" "),t("p",[s._v("这里的"),t("code",[s._v(".")]),s._v("是正则表达式中用于匹配任意一个字符的，更多正则表达式的内容可以查看："),t("a",{attrs:{href:"https://github.com/ziishaned/learn-regex",target:"_blank",rel:"noopener noreferrer"}},[s._v("Github：learn-regex"),t("OutboundLink")],1)]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("你可以不查询表来测试正则表达式，像这样"),t("code",[s._v("select 'hello' regexp '[:alpha:]';")]),s._v("，如果匹配则返回1，反之为0。")])]),t("h3",{attrs:{id:"_3-13-as"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-13-as"}},[s._v("#")]),s._v(" 3.13 as")]),s._v(" "),t("p",[s._v("为列取别名。")]),s._v(" "),t("p",[s._v("常见用法：")]),s._v(" "),t("ol",[t("li",[s._v("别名："),t("code",[s._v("select t.column as new_name from table as t;")])]),s._v(" "),t("li",[s._v("简写："),t("code",[s._v("select t.column new_name from table t;")])])]),s._v(" "),t("h3",{attrs:{id:"_3-14-group-by"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-14-group-by"}},[s._v("#")]),s._v(" 3.14 group by")]),s._v(" "),t("p",[s._v("将数据进行分组")]),s._v(" "),t("p",[s._v("常见用法：")]),s._v(" "),t("ol",[t("li",[s._v("按列分组："),t("code",[s._v("select column count(column) from table group by column;")])])]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("p",[s._v("GROUP BY子句必须出现在WHERE子句之后，ORDER BY子句之前。")])]),t("h3",{attrs:{id:"_3-15-having"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-15-having"}},[s._v("#")]),s._v(" 3.15 having")]),s._v(" "),t("p",[s._v("对分组数据进行过滤，类似where，但是where不能过滤分组数组，因为where是用于过滤行的，大多数情况下都可以使用having代替where。")]),s._v(" "),t("p",[s._v("常见用法：")]),s._v(" "),t("ol",[t("li",[s._v("分组并取count大于等于2的："),t("code",[s._v("select column count(column) from table group by column having count(*) >= 2;")])])]),s._v(" "),t("h3",{attrs:{id:"_3-16-insert"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-16-insert"}},[s._v("#")]),s._v(" 3.16 insert")]),s._v(" "),t("p",[s._v("新增记录。")]),s._v(" "),t("p",[s._v("常见用法：")]),s._v(" "),t("ol",[t("li",[s._v("按照表中的列顺序插入："),t("code",[s._v("insert into table values(xxx,xxx,xxx...);")])]),s._v(" "),t("li",[s._v("自定义列及顺序插入："),t("code",[s._v("insert into table(id,name,age...) values(null,'test',18...)")])]),s._v(" "),t("li",[s._v("多行插入："),t("code",[s._v("insert into table values(xxx,xxx,xxx...),(xxx,xxx,xxx...)")])])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("你还可以在insert的values部分使用select语句返回的值作为value插入，需要注意的是涉及唯一的列需要变动时，如果id设置了自增那么可以不用插入id。")]),s._v(" "),t("p",[s._v("类似"),t("code",[s._v("INSERT INTO table(column1,column2) SELECT column1, column2 FROM articles")])])]),t("h3",{attrs:{id:"_3-17-update"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-17-update"}},[s._v("#")]),s._v(" 3.17 update")]),s._v(" "),t("p",[s._v("更新记录。")]),s._v(" "),t("p",[s._v("常见用法：")]),s._v(" "),t("ol",[t("li",[s._v("更新指定数据："),t("code",[s._v("update table set column1 = 1 where column2 = 2")])]),s._v(" "),t("li",[s._v("更新多列："),t("code",[s._v("update table set column1 = 1,column2 = 2 where column3 = 3")])])]),s._v(" "),t("h3",{attrs:{id:"_3-18-delete"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-18-delete"}},[s._v("#")]),s._v(" 3.18 delete")]),s._v(" "),t("p",[s._v("删除数据。")]),s._v(" "),t("p",[s._v("常见用法：")]),s._v(" "),t("ol",[t("li",[s._v("删除指定记录："),t("code",[s._v("delete from table where column1 = 1")])])]),s._v(" "),t("h2",{attrs:{id:"_4-函数和运算符"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-函数和运算符"}},[s._v("#")]),s._v(" 4. 函数和运算符")]),s._v(" "),t("p",[s._v("此章节内容参考："),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/functions.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方手册 - 函数与运算符章节"),t("OutboundLink")],1),s._v("，"),t("a",{attrs:{href:"https://www.w3schools.com/mysql/mysql_ref_functions.asp",target:"_blank",rel:"noopener noreferrer"}},[s._v("w3school - MySQL函数"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("手册版本为8.0")])]),t("h3",{attrs:{id:"_4-1-运算符"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-运算符"}},[s._v("#")]),s._v(" 4.1 运算符")]),s._v(" "),t("p",[s._v("四则运算（+、-、*、/）是最为常见的运算符。例如你想对一个数进行平方，可以这样 "),t("code",[s._v("select column column * column square from table;")])]),s._v(" "),t("p",[s._v("更多内容建议参考"),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/non-typed-operators.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方手册-运算符"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"_4-2-函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-函数"}},[s._v("#")]),s._v(" 4.2 函数")]),s._v(" "),t("p",[s._v("如果是想细节了解函数，建议参考上面的官方手册。")]),s._v(" "),t("p",[s._v("以下仅简单按照几个方面介绍一些常用的函数。")]),s._v(" "),t("ul",[t("li",[s._v("字符串函数")]),s._v(" "),t("li",[s._v("数值函数")]),s._v(" "),t("li",[s._v("日期与时间函数")])]),s._v(" "),t("h4",{attrs:{id:"_4-2-1-字符串函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1-字符串函数"}},[s._v("#")]),s._v(" 4.2.1 字符串函数")]),s._v(" "),t("p",[t("strong",[s._v("concat()")]),s._v("：用于拼接字符串，"),t("code",[s._v("select concat('hello',' world !');")]),t("br"),s._v(" "),t("strong",[s._v("left()")]),s._v("：返回字符串左边n位，"),t("code",[s._v("right()")]),s._v("同理"),t("br"),s._v(" "),t("strong",[s._v("length()")]),s._v("：返回字符串长度"),t("br"),s._v(" "),t("strong",[s._v("lower()")]),s._v("：小写函数。大写为"),t("code",[s._v("upper()")]),t("br"),s._v(" "),t("strong",[s._v("trim()")]),s._v("：删除前后空格，衍生函数："),t("code",[s._v("ltrim()")]),s._v("、"),t("code",[s._v("rtrim()")]),t("br"),s._v(" "),t("strong",[s._v("locate()")]),s._v("：返回子字符串在字符串中第一次出现的位置，"),t("code",[s._v('SELECT LOCATE("3", "W3Schools.com");')]),t("br"),s._v(" "),t("strong",[s._v("repeat()")]),s._v("：重复字符串，"),t("code",[s._v('SELECT REPEAT("SQL Tutorial", 3);')]),t("br"),s._v(" "),t("strong",[s._v("replace()")]),s._v(": 替换字符串，"),t("code",[s._v('SELECT REPLACE("SQL Tutorial", "SQL", "HTML");')]),t("br"),s._v(" "),t("strong",[s._v("reverse()")]),s._v("：反转字符串，"),t("code",[s._v('SELECT REVERSE("SQL Tutorial");')]),t("br"),s._v(" "),t("strong",[s._v("substr()")]),s._v("：截取字符串，同"),t("code",[s._v("substring()")]),s._v("，"),t("code",[s._v('SELECT SUBSTR("SQL Tutorial", 5, 3);')])]),s._v(" "),t("h4",{attrs:{id:"_4-2-2-数值函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-数值函数"}},[s._v("#")]),s._v(" 4.2.2 数值函数")]),s._v(" "),t("p",[t("strong",[s._v("abs()")]),s._v("：获取数值绝对值"),t("br"),s._v(" "),t("strong",[s._v("avg()")]),s._v("：平均值，"),t("code",[s._v("SELECT AVG(Price) AS AveragePrice FROM Products;")]),t("br"),s._v(" "),t("strong",[s._v("sum()")]),s._v("：求和"),t("br"),s._v(" "),t("strong",[s._v("max()")]),s._v("：获取某列最大值，"),t("code",[s._v("min()")]),s._v("则相反"),t("br"),s._v(" "),t("strong",[s._v("ceil()")]),s._v("：想上取整，同"),t("code",[s._v("ceiling()")]),t("br"),s._v(" "),t("strong",[s._v("floor()")]),s._v("：向下取整"),t("br"),s._v(" "),t("strong",[s._v("count()")]),s._v("：统计数值"),t("br"),s._v(" "),t("strong",[s._v("mod()")]),s._v("：取模"),t("br"),s._v(" "),t("strong",[s._v("greatest()")]),s._v("：返回列表最大值，"),t("code",[s._v("SELECT GREATEST(3, 12, 34, 8, 25);")]),s._v("，"),t("code",[s._v("least()")]),s._v("则相反"),t("br"),s._v(" "),t("strong",[s._v("pow()")]),s._v("：幂运算，同"),t("code",[s._v("power()")]),s._v("，"),t("code",[s._v("SELECT POW(4, 3);")]),t("br"),s._v(" "),t("strong",[s._v("rand()")]),s._v("：返回一个大于等于0小于1的浮点数。"),t("br"),s._v(" "),t("strong",[s._v("round()")]),s._v("：将数值进行四舍五入。四舍五入到小数点后两位："),t("code",[s._v("SELECT ROUND(135.375, 2);")]),t("br"),s._v(" "),t("strong",[s._v("sqrt()")]),s._v("：平方根")]),s._v(" "),t("p",[s._v("除此之外还有许多都是数学函数，类似三角函数与反三角函数，弧度角度转换函数，对数函数等。")]),s._v(" "),t("h4",{attrs:{id:"_4-3-3-日期与时间函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-3-日期与时间函数"}},[s._v("#")]),s._v(" 4.3.3 日期与时间函数")]),s._v(" "),t("p",[t("strong",[s._v("curdate()")]),s._v("：当前日期，同"),t("code",[s._v("current_date()")]),t("br"),s._v(" "),t("strong",[s._v("curtime()")]),s._v("：当前时间，同"),t("code",[s._v("current_time()")]),t("br"),s._v(" "),t("strong",[s._v("current_timestamp()")]),s._v("：当前日期加时间，类似"),t("code",[s._v("now()")]),s._v("，"),t("code",[s._v("localtime()")]),t("br"),s._v(" "),t("strong",[s._v("datediff()")]),s._v("：日期差，"),t("code",[s._v('SELECT DATEDIFF("2017-06-25", "2017-06-15");')]),t("br"),s._v(" "),t("strong",[s._v("adddate()")]),s._v("：增加日期，"),t("code",[s._v('SELECT ADDDATE("2017-06-15", INTERVAL 10 DAY);')]),t("br"),s._v(" "),t("strong",[s._v("addtime()")]),s._v("：增加时间，"),t("code",[s._v('SELECT ADDTIME("2017-06-15 09:34:21", "2");')])]),s._v(" "),t("p",[s._v("此处基本没介绍年月日时分秒，但是相关函数都有。")]),s._v(" "),t("h4",{attrs:{id:"_4-4-4-流程控制函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-4-流程控制函数"}},[s._v("#")]),s._v(" 4.4.4 流程控制函数")]),s._v(" "),t("p",[s._v("不知道为什么官方手册把这归结到函数而不是语句，但这都不是重点，重点是流程控制。")]),s._v(" "),t("p",[s._v("因为觉得介绍看的不如直接上代码，所以这里直接上代码。")]),s._v(" "),t("ul",[t("li",[s._v("case、then、when、else、end")])]),s._v(" "),t("p",[s._v("这是一套十分常见的流程控制组合。")]),s._v(" "),t("div",{staticClass:"language-SQL line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CASE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("THEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'one'")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("THEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'two'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ELSE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'more'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("END")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'one'")]),s._v("\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CASE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("THEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'true'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ELSE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'false'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("END")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'true'")]),s._v("\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CASE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BINARY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'B'")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'a'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("THEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'b'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("THEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("END")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("ul",[t("li",[s._v("IF(expr1,expr2,expr3)")])]),s._v(" "),t("p",[s._v("如果 expr1 为 TRUE（expr1 <> 0 和 expr1 <> NULL），IF() 返回 expr2。否则，它返回 expr3。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'yes'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'no'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'yes'")]),s._v("\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STRCMP"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'no'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'yes'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'no'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("ul",[t("li",[s._v("IFNULL(expr1,expr2)")])]),s._v(" "),t("p",[s._v("如果 expr1 不为 NULL，则 IFNULL() 返回 expr1；否则返回 expr2。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" IFNULL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" IFNULL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" IFNULL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" IFNULL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'yes'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'yes'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("ul",[t("li",[s._v("NULLIF(expr1,expr2)")])]),s._v(" "),t("p",[s._v("如果 expr1 = expr2 为真，则返回 NULL，否则返回 expr1。这与 CASE WHEN expr1 = expr2 THEN NULL ELSE expr1 END 相同。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("NULLIF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("NULLIF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"_5-高级部分"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-高级部分"}},[s._v("#")]),s._v(" 5. 高级部分")]),s._v(" "),t("h3",{attrs:{id:"_5-1-子查询-subquery"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-子查询-subquery"}},[s._v("#")]),s._v(" 5.1 子查询（subquery）")]),s._v(" "),t("p",[s._v("子查询就是嵌套在其他查询中的查询。")]),s._v(" "),t("p",[s._v("举个栗子")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("column")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("column")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("column")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("column")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("以上是最为简单的子查询，接下来介绍一种作为"),t("strong",[s._v("计算字段的子查询")])]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" column1 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("count")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" table2 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" table1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("column1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" table2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("column1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" table1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("这里提前使用了联表，目的是为了查出当前的某些主题在其他表的其他统计信息。")]),s._v(" "),t("h3",{attrs:{id:"_5-2-连表查询-join"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-连表查询-join"}},[s._v("#")]),s._v(" 5.2 连表查询（join）")]),s._v(" "),t("p",[t("strong",[s._v("连表查询")]),s._v("是SQL中十分常见的做法，因为如果把所有信息都放在同一张表中的话，那么这张表将会十分复杂，并且有些信息可能是大量重复的数据，所以连表查询也可以减少数据库的空间占用。")]),s._v(" "),t("p",[s._v("通常的做法是提供多张表，然后在关联表中使用一个字段与主表的"),t("strong",[s._v("主键")]),s._v("进行关联，因此关联表中的这个字段也被称为"),t("strong",[s._v("外键")]),s._v("。")]),s._v(" "),t("p",[s._v("既然数据存放在不同表，那么使用简单查询就不可能查询出我们需要的所有信息，所以此时就需要使用连表查询。")]),s._v(" "),t("p",[s._v("举个例子，现在有一张商品表products与订单表orders，我们需要从订单金额大于500的商品信息（在商品表才有商品信息，订单表只有商品id），所以此时我们可以这样：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" product"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("product_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" orders"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("amount "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" orders"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" products "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" orders"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("product_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" products"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("在上面的SQL语句中，我们在查询了两个在不同表的字段 "),t("strong",[s._v("（")]),s._v(" 使用表名.列名的方式，这种方式称之为 "),t("strong",[s._v("完全限定名）")]),s._v(" ，通过from后面添加两张表名（使用逗号隔开），并且在where条件中补充连接关系，这样便是一个最简单的连表查询。")]),s._v(" "),t("p",[s._v("如果不在where条件中补充联结关系，那么返回的结果将会是两表的笛卡尔积，这种方式也称之为"),t("strong",[s._v("交叉连接")]),s._v("（"),t("code",[s._v("cross join")]),s._v("）。")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("内连接")])])]),s._v(" "),t("p",[s._v("连接其实也分为不同的类型，上述的写法其实是"),t("strong",[s._v("内连接")]),s._v("的简化写法，事实上它和以下这种写法是一样的")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" product"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("product_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" orders"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("amount "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" orders "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("inner")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("join")]),s._v(" products "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" orders"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("product_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" products"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("两者的区别在乎这里我们明确使用了"),t("code",[s._v("inner join")]),s._v("关键字进行内连接，同时使用"),t("code",[s._v("on")]),s._v("而不是"),t("code",[s._v("where")]),s._v("进行连接关系的补充。")]),s._v(" "),t("p",[s._v("连接不仅局限于两张表，如果需要连接多张表，则需要继续补充相应的连接关系。但是需要注意，连表是有性能代价的，"),t("strong",[s._v("连接的表越多，性能下降也越大。")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("外连接")])])]),s._v(" "),t("p",[s._v("外连接与内连接不同在于，内连接只会返回匹配的行，而外连接除了返回匹配的行还会返回不匹配的行。")]),s._v(" "),t("p",[s._v("外连接通常分为"),t("strong",[s._v("左外连接")]),s._v("（"),t("code",[s._v("left outer join")]),s._v("，简写为"),t("code",[s._v("left join")]),s._v("）与"),t("strong",[s._v("右外连接")]),s._v("("),t("code",[s._v("right outer join")]),s._v("，简写为"),t("code",[s._v("right join")]),s._v(")。")]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("p",[s._v("MySQL是没有"),t("code",[s._v("full join")]),s._v("的，想实现这个功能可以考虑下面的组合查询（union）。")])]),t("p",[s._v("左外连接即使返回左表的所有行，即使行没有与右表相匹配，右连接则相反。")]),s._v(" "),t("p",[s._v("通过韦恩图可以获得更为直观的信息。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://www.runoob.com/wp-content/uploads/2014/03/img_innerjoin.gif",alt:"img_innerjoin.gif"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://www.runoob.com/wp-content/uploads/2014/03/img_leftjoin.gif",alt:"img_leftjoin.gif"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://www.runoob.com/wp-content/uploads/2014/03/img_rightjoin.gif",alt:"img_rightjoin.gif"}})]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("自连接")])])]),s._v(" "),t("p",[s._v("自连接是把同一张表进行联表查的方式，自连接的好处在于对于那些只在一张表使用子查询时，可以考虑自连接，因为自连接的性能通常会比子查询要好（需要你自己测试）。")]),s._v(" "),t("p",[s._v("下面举个例子，假设我们有张教师表，我们需要从该表中查询出所有科目等于"),t("strong",[s._v("id为1的老师的科目")]),s._v("的教师姓名，此时如果使用子查询则可以：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" subject "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" teachers "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" subject "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" subject "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" teachers "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("自连接的方式：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" t1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" t1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("subject "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" teachers t1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" teachers t2 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" t1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("subject "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" t2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("subject "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v(" t2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("更多参考："),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/join.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方手册 - JOIN Clause"),t("OutboundLink")],1)])]),t("h3",{attrs:{id:"_5-3-组合查询-union"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-组合查询-union"}},[s._v("#")]),s._v(" 5.3 组合查询（union）")]),s._v(" "),t("p",[s._v("组合查询其实就是把多个查询结果进行并集处理。在上述连表查询中我们提到过使用组合查询实现全连接，通过左连接与右连接进行并集处理，返回的结果正好是全连接，通过上述的韦恩图也可以非常直观的感受到。")]),s._v(" "),t("p",[s._v("组合查询的使用非常简单，但是这里仍然给出一个例子：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" age"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("level")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" teachers "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" age "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("union")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" age"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("level")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" teachers "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("level")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("上述的需求可能是，最近学校要选出一些教师，要求教师年纪最好要小（30之内），如果年纪大了的话，那么等级必须大于3，因此使用并集处理就可以获取我们所有符合条件的教师。")]),s._v(" "),t("p",[s._v("你可能会疑惑在这个情况下，使用or不也能完成嘛。事实上这里仅仅是为了介绍union的使用，实际上union的结果集大多不在一张表，而且也不会如此简单。")]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("p",[s._v("在使用union时，你应该注意，union必须连接两条或以上的select语句，并且每个查询必须包含相同的列，表达式或者聚集函数（顺序可以不同），此外，列的数据也必须兼容（不必完全相同，但需要能隐式转换）。")])]),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("p",[s._v("需要注意的是，union默认会合并重复行，比如上方的例子中在30岁以下的同时level大于3的教师就会被自动合并，如果不想被合并可以使用"),t("code",[s._v("union all")]),s._v("即可。")])]),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("p",[s._v("对union的排序不应该对单独的select语句进行排序，而是应该在最后进行一个"),t("code",[s._v("order by")]),s._v("排序即可。")])]),t("h3",{attrs:{id:"_5-4-全文索引-fulltext-index"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-全文索引-fulltext-index"}},[s._v("#")]),s._v(" 5.4 全文索引（fulltext index）")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("手册参考：\n- [官方手册8.0 - 全文索引功能](https://dev.mysql.com/doc/refman/8.0/en/fulltext-search.html)  \n- [官方手册8.0 - InnoDB全文索引](https://dev.mysql.com/doc/refman/8.0/en/innodb-fulltext-index.html)\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("全文索引通常用于加快基于大文本列的查询。MySQL早期的只有MyISAM引擎支持全文索引，不过在5.6之后，InnoDB引擎也开始支持全文索引，但是这个分词默认是针对英文的，中文的分词在5.7开始内置了ngram插件，这个插件可以支持中文、日语、韩语，所以对于想使用中文索引的人建议使用5.7+的版本。")]),s._v(" "),t("p",[s._v("InnoDB全文索引采用倒排索引设计。倒排索引存储一个单词列表，对于每个单词，还有一个该单词出现的文档列表。为了支持邻近搜索，每个单词的位置信息也被作为字节偏移进行存储。")]),s._v(" "),t("p",[s._v("对于大型数据集，将数据加载到没有FULLTEXT索引的表然后创建索引比将数据加载到具有现有FULLTEXT索引的表要快得多。")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("全文索引的创建与删除")])])]),s._v(" "),t("p",[s._v("创建：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("div",{staticClass:"highlight-lines"},[t("br"),t("br"),t("br"),t("br"),t("br"),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("br"),t("br")]),t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" opening_lines "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n       id "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UNSIGNED")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AUTO_INCREMENT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n       opening_line "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TEXT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n       author "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n       title "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n       FULLTEXT idx "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("opening_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENGINE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("InnoDB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("div",{staticClass:"language-sql line-numbers-mode"},[t("div",{staticClass:"highlight-lines"},[t("div",{staticClass:"highlighted"},[s._v(" ")]),t("br")]),t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" FULLTEXT "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" idx "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" opening_lines"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("opening_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language-sql line-numbers-mode"},[t("div",{staticClass:"highlight-lines"},[t("br"),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("br"),t("br")]),t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 此方法添加的索引名即为列名")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" opening_lines  \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" FULLTEXT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("opening_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("p",[s._v("将全文索引添加到没有"),t("code",[s._v("FTS_DOC_ID")]),s._v("列的表时，会返回"),t("code",[s._v("InnoDB rebuilding table to add column FTS_DOC_ID")]),s._v("警告。"),t("br"),s._v("\n如果您不关心"),t("code",[s._v("CREATE FULLTEXT INDEX")]),s._v("性能，请忽略该"),t("code",[s._v("FTS_DOC_ID")]),s._v("列， InnoDB为您创建它。")])]),t("p",[s._v("删除：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("drop")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("index")]),s._v(" idx "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" opening_lines\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("或者")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" opening_lines "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("drop")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("index")]),s._v(" idx\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[t("strong",[s._v("使用全文索引")])])]),s._v(" "),t("p",[s._v("通过在where之后添加"),t("code",[s._v("match()")]),s._v(","),t("code",[s._v("against()")]),s._v("即可根据全文索引搜索，需要注意的是，在默认分词插件下，通常是通过空格,逗号，句号进行分词，并且较短的字符串（默认是3）是不会被收录到单词列表。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" opening_line "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" opening_lines "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("match")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("opening_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" against"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxx'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("默认情况下，搜索以不区分大小写的方式执行。要执行区分大小写的全文搜索，请对索引列使用区分大小写或二进制排序规则。例如，utf8mb4 可以为使用字符集的列分配排序规则 utf8mb4_0900_as_cs或 utf8mb4_bin使其区分大小写以进行全文搜索。")])]),t("p",[s._v("在某些情况下，使用like操作也能完成类似的操作，但是like的效率比较低（精度高）。而全文索引降低了一些精度，换来分析结果相关度，这一点是非常重要的，在下面我们将继续通过一个例子来介绍如何查询结果相关度或者权重。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" opening_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("match")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("opening_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" against"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxx'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" weight "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" opening_lines\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("通过将"),t("code",[s._v("match(opening_line) against('xxx')")]),s._v("作为字段，我们可以看到每列对于该索引条件的权重。")]),s._v(" "),t("p",[s._v("默认通过全文索引查询的结果就是根据权重进行排序的，这一点是"),t("code",[s._v("like")]),s._v("这种高精度硬匹配所无法做到的。")]),s._v(" "),t("p",[s._v("在上述示例中，我们没有介绍全文索引的工作模式，"),t("strong",[s._v("默认情况下")]),s._v("，全文索引使用"),t("strong",[s._v("自然语言模式")]),s._v("，即"),t("code",[s._v("IN NATURAL LANGUAGE MODE")]),s._v("，除了该模式外，还有"),t("strong",[s._v("布尔模式")]),s._v("和"),t("strong",[s._v("查询扩展模式")]),s._v("。")]),s._v(" "),t("p",[s._v("更多参考："),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/fulltext-natural-language.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方手册8.0 - 自然语言全文搜索"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("strong",[s._v("布尔模式")]),s._v("：布尔模式通常对字符串进行一些逻辑判断，比如判断某些单词存在同时某些单词不存在可以这样：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" articles "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MATCH")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("title"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("body"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    AGAINST "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'+MySQL -YourSQL'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BOOLEAN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MODE")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("在上述示例中，"),t("code",[s._v("+")]),s._v("和"),t("code",[s._v("-")]),s._v("运算符分别指示一个词必须存在或不存在，"),t("code",[s._v("IN BOOLEAN MODE")]),s._v("用于确定采用布尔模式。")]),s._v(" "),t("p",[s._v("除了"),t("code",[s._v("+")]),s._v("和"),t("code",[s._v("-")]),s._v("之外还有许多其他的运算符，同时布尔查询也不会按照相关度进行排序。")]),s._v(" "),t("p",[s._v("更多参考："),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方手册8.0 - 布尔全文搜索"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("strong",[s._v("查询扩展模式")]),s._v("：如果你想对结果进行扩展（即使结果不包含相关关键词），那么你可以使用"),t("code",[s._v("with query expansion")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" opening_line "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" opening_lines "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("match")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("opening_line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" against"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxx'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" query expansion"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("举个例子，你需要查询的词为"),t("code",[s._v("Newtons")]),s._v("，现在有一条记录为"),t("code",[s._v("Apple fell on Newton's head.")]),s._v("，那么与之相关词的就可能是"),t("code",[s._v("head")]),s._v("，所以结果可能就会返会包含"),t("code",[s._v("head")]),s._v("的记录。")]),s._v(" "),t("p",[s._v("更多参考："),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/fulltext-query-expansion.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方手册8.0 - 带有查询扩展的全文搜索"),t("OutboundLink")],1)]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("ngram 全文解析器")])])]),s._v(" "),t("p",[s._v("ngram是"),t("code",[s._v("mysql 5.7")]),s._v("开始内置的中文分词插件，根据n来确定分词基数的，在中文情况下，词语通常为两个字，所以ngram默认的token size就是2，但是这个值也可以进行配置，取值范围为[1,10].")]),s._v(" "),t("ol",[t("li",[s._v("命令行参数配置："),t("code",[s._v("mysqld --ngram_token_size=2")])]),s._v(" "),t("li",[s._v("配置文件：")])]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[s._v("mysqld")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("ngram_token_size")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("2")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("创建时指定ngram作为解析器：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("div",{staticClass:"highlight-lines"},[t("br"),t("br"),t("br"),t("br"),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("br"),t("br"),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("br"),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("br")]),t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" articles "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n      id "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UNSIGNED")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AUTO_INCREMENT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      title "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      body "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TEXT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      FULLTEXT "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("title"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("body"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" PARSER ngram\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENGINE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("InnoDB")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CHARACTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" utf8mb4"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" FULLTEXT "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" ft_index "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" articles "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("title"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("body"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" PARSER ngram"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" articles "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" FULLTEXT "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" ft_index "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("title"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("body"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" PARSER ngram"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("p",[s._v("默认情况下，ngram 解析器使用默认停用词列表，其中包含英文停用词列表。对于适用于中文、日语或韩语的停用词列表，您必须创建自己的停用词列表。有关创建停用词列表的信息，请参阅"),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/fulltext-stopwords.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("全文停用词"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("p",[s._v("Github中文停用词仓库: "),t("a",{attrs:{href:"https://github.com/goto456/stopwords",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/goto456/stopwords"),t("OutboundLink")],1)])]),t("p",[s._v("对于"),t("strong",[s._v("自然语言模式")]),s._v("，搜索词被转换为ngram"),t("strong",[s._v("词的联合")]),s._v("。例如默认分词基数（2）的情况下，“长安城”将被分解成“长安 安城”，如果现在有两条记录，分别包含“长安”，“长安城”，那么在自然语言模式下，他们都将被匹配。")]),s._v(" "),t("p",[s._v("对于"),t("strong",[s._v("布尔模式")]),s._v("，搜索词将转换为ngram"),t("strong",[s._v("短语搜索")]),s._v("，同样在上述情况，则只有“长安城”被匹配。")]),s._v(" "),t("p",[s._v("如果你想查询分词的结果，官方有个示例：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USE")]),s._v(" test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" articles "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n      id "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UNSIGNED")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AUTO_INCREMENT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      title "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      body "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TEXT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      FULLTEXT "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("title"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("body"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" PARSER ngram\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENGINE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("InnoDB")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CHARACTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" utf8mb4"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" NAMES utf8mb4"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" articles "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("title"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("body"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VALUES")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'数据库管理'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'在本教程中我将向你展示如何管理数据库'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'数据库应用开发'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'学习开发数据库应用程序'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GLOBAL")]),s._v(" innodb_ft_aux_table"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test/articles"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" INFORMATION_SCHEMA"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("INNODB_FT_INDEX_CACHE "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ORDER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" doc_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" position"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("p",[s._v("更多参考："),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/fulltext-search-ngram.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方手册8.0 - ngram 全文解析器"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"_5-5-视图-view"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-5-视图-view"}},[s._v("#")]),s._v(" 5.5 视图（view）")]),s._v(" "),t("p",[s._v("在 SQL 中，视图是基于 SQL 语句的结果集的可视化的"),t("strong",[s._v("虚拟")]),s._v("表。")]),s._v(" "),t("p",[s._v("视图包含行和列，就像一个真实的表。视图中的字段就是来自一个或多个数据库中的真实的表中的字段。我们可以向视图添加 SQL 函数、WHERE 以及 JOIN 语句，我们也可以提交数据，就像这些来自于某个单一的表。")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("ul",[t("li",[s._v("数据库的设计和结构不会受到视图中的函数、where 或 join 语句的影响。")]),s._v(" "),t("li",[s._v("视图总是显示最近的数据。每当用户查询视图时，数据库引擎通过使用 SQL 语句来重建数据。")])])]),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("ul",[t("li",[s._v("视图名与表名不可重复。")]),s._v(" "),t("li",[s._v("使用复杂视图前请测试性能。")])])]),t("p",[t("strong",[s._v("视图的好处")])]),s._v(" "),t("ol",[t("li",[s._v("重用sql")]),s._v(" "),t("li",[s._v("简化sql")]),s._v(" "),t("li",[s._v("保护数据，只能操作表的特定部分")])]),s._v(" "),t("p",[t("strong",[s._v("基本用法")])]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建视图")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VIEW")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Products Above Average Price"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" ProductName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("UnitPrice\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" Products\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" UnitPrice"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("AVG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("UnitPrice"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" Products"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询视图")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Products Above Average Price"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看视图创建过程")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VIEW")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Products Above Average Price"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 更新视图")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("OR")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("REPLACE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VIEW")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("视图名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" column_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" table_name\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" condition"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除视图")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VIEW")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("视图名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("h3",{attrs:{id:"_5-6-存储过程-stored-procedure"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-6-存储过程-stored-procedure"}},[s._v("#")]),s._v(" 5.6 存储过程（Stored Procedure）")]),s._v(" "),t("p",[s._v("存储过程（Stored Procedure）是在大型数据库系统中，"),t("strong",[s._v("一组为了完成特定功能的SQL 语句集")]),s._v("。")]),s._v(" "),t("p",[s._v("它存储在数据库中，一次编译后永久有效，用户通过指定存储过程的名字并给出参数（如果该存储过程带有参数）来执行它。")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("存储过程的优点：可重用、使用简单、安全、高性能。")]),s._v(" "),t("p",[s._v("存储过程的创建权限与执行权限是分开的。")])]),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("p",[s._v("一般来说，存储过程的编写比基本SQL语句复杂，编写存储过程需要更高的技能，更丰富的经验。")])]),t("p",[s._v("以下仅介绍基本的语法，实际上的存储过程十分复杂，建议参考：")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://www.runoob.com/w3cnote/mysql-stored-procedure.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("MySQL 存储过程 | 菜鸟教程"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/create-procedure.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("CREATE PROCEDURE and CREATE FUNCTION Statements | MySQL"),t("OutboundLink")],1)])]),s._v(" "),t("p",[t("strong",[s._v("基本用法")])]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建存储过程")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PROCEDURE")]),s._v(" two_sum"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("in")]),s._v(" num1 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 入参")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("in")]),s._v(" num2 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("out")]),s._v(" sum "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 出参")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" num1"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("num2 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" sum"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看存储过程创建过程")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" two_sum"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 调用存储过程")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("call")]),s._v(" two_sum"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@ans")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询存储过程返回的变量")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@ans")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除存储过程")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("drop")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" two_sum"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改存储过程只能改变存储过程的特征，不能修改过程的参数以及过程体。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PROCEDURE")]),s._v(" proc_name "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("characteristic "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\ncharacteristic: {\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COMMENT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'string'")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LANGUAGE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" { "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CONTAINS")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("NO")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("READS")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATA")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MODIFIES")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATA")]),s._v(" }\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),s._v(" SECURITY { "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFINER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INVOKER")]),s._v(" }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br")])]),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("p",[s._v("默认的MySQL语句分隔符为"),t("code",[s._v(";")]),s._v("，如果你使用的是mysql命令行创建存储过程，则"),t("code",[s._v(";")]),s._v("会被忽略而导致语法错误。\n解决办法是临时更改命令行实用程序的语句分隔符")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 临时修改为//")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("delimiter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改为正常情况")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("delimiter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])]),t("h3",{attrs:{id:"_5-7-游标-cursor"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-7-游标-cursor"}},[s._v("#")]),s._v(" 5.7 游标（cursor）")]),s._v(" "),t("p",[s._v("游标是一个存储在MySQL服务器上的数据库查询， 它不是一条SELECT语句，而是被该语句检索出来的结果集。")]),s._v(" "),t("p",[s._v("游标在MySQL中只能与存储过程协同使用。")]),s._v(" "),t("p",[t("strong",[s._v("基础使用")])]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" testcursor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("out")]),s._v(" res "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("begin")]),s._v("\n\n\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 定义本地变量done")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v(" done "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 创建游标")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v(" mycursor "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cursor")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" id "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" gowow_admin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- '02000'事件(未找到条件，fetch循环到最后触发)触发设置done变量")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("continue")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("handler")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" sqlstate "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'02000'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" done "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\n\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 打开游标")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open")]),s._v(" mycursor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\n\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 循环")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("repeat")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 使用游标")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fetch")]),s._v(" mycursor "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" res"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\tuntil done "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("repeat")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\n\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 关闭游标")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("close")]),s._v(" mycursor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br")])]),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"}),t("p",[t("strong",[s._v("DECLARE语句的次序")])]),s._v(" "),t("p",[s._v("DECLARE语句的发布存在特定的次序。用DECLARE语句定义的局部变量必须在定义任意游标或句柄之前定义，而句柄必须在游标之后定义。不遵守此顺序将产生错误消息。")])]),t("h3",{attrs:{id:"_5-8-触发器-trigger"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-8-触发器-trigger"}},[s._v("#")]),s._v(" 5.8 触发器（trigger）")]),s._v(" "),t("p",[s._v("触发器是存储在数据库目录中的一组SQL语句。每当与表相关联的"),t("strong",[s._v("事件")]),s._v("发生时，就会执行或触发SQL触发器，例如"),t("strong",[s._v("插入")]),s._v("，"),t("strong",[s._v("更新")]),s._v("或"),t("strong",[s._v("删除")]),s._v("。")]),s._v(" "),t("p",[s._v("触发事刻有两种状态，分别是"),t("code",[s._v("before")]),s._v("和"),t("code",[s._v("after")]),s._v("。")]),s._v(" "),t("p",[s._v("使用"),t("code",[s._v("before")]),s._v("可以使用"),t("code",[s._v("OLD")]),s._v("来获取修改前的临时表数据。")]),s._v(" "),t("p",[s._v("使用"),t("code",[s._v("after")]),s._v("可以使用"),t("code",[s._v("NEW")]),s._v("来获取修改后的临时表数据。")]),s._v(" "),t("p",[t("strong",[s._v("基本用法")])]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建触发器 MySQL5之后不允许返回结果 所以使用变量接收")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("trigger")]),s._v(" mytrigger "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("after")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("insert")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for each row")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"my trigger is staring"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@res")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除触发器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("drop")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("trigger")]),s._v(" mytrigger"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 触发器不能被更新")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("更多参考："),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/trigger-syntax.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Trigger Syntax and Examples | MySQL"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"_5-9-事务-transaction"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-9-事务-transaction"}},[s._v("#")]),s._v(" 5.9 事务（transaction）")]),s._v(" "),t("p",[t("strong",[s._v("事务")]),s._v(" 的概念：一组sql语句，我们需要让它要么全部成功，要不直接失败。失败时触发的操作称之为"),t("strong",[s._v("回滚（rollback）")]),s._v("，当且仅当事务全部执行成功时，事务才被"),t("strong",[s._v("提交（commit）")]),s._v("。同时事务中还可设置"),t("strong",[s._v("保留点（savepoint）")]),s._v("，它可以仅回滚到某个状态而不是回退整个事务。")]),s._v(" "),t("p",[t("strong",[s._v("基本使用")])]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("start")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("transaction")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 一些操作")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("savepoint")]),s._v(" sp1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rollback")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" sp1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rollback")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("commit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("MySQL默认状态下"),t("code",[s._v("autocommit = 1")]),s._v("，所以你每次输入SQL语句都会自动提交并立即生效，你可以通过设置"),t("code",[s._v("set autocommit = 0")]),s._v("来关闭自动提交。")]),s._v(" "),t("p",[s._v("更多参考："),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/commit.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("START TRANSACTION, COMMIT, and ROLLBACK Statements | MySQL"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"_6-一些提示与建议"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-一些提示与建议"}},[s._v("#")]),s._v(" 6. 一些提示与建议")]),s._v(" "),t("h3",{attrs:{id:"_6-1-select语句的关键字顺序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-select语句的关键字顺序"}},[s._v("#")]),s._v(" 6.1 select语句的关键字顺序")]),s._v(" "),t("p",[s._v("依次为，"),t("code",[s._v("select")]),s._v("、"),t("code",[s._v("from")]),s._v("、"),t("code",[s._v("where")]),s._v("、"),t("code",[s._v("group by")]),s._v("、"),t("code",[s._v("having")]),s._v("、"),t("code",[s._v("order by")]),s._v("、"),t("code",[s._v("limit")])]),s._v(" "),t("h2",{attrs:{id:"_7-常见sql语句"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-常见sql语句"}},[s._v("#")]),s._v(" 7. 常见SQL语句")]),s._v(" "),t("h3",{attrs:{id:"_7-1-数据库相关"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-数据库相关"}},[s._v("#")]),s._v(" 7.1 数据库相关")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建数据库")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("database")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("数据库名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("character")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("字符编码"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看数据库")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("databases")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看数据库创建详情")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("database")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("数据库名字"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改数据库编码")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("database")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("数据库名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("character")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("字符编码"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 切换当前数据库")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("数据库名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除数据库")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("drop")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("database")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("数据库名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("h3",{attrs:{id:"_7-2-表相关"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-表相关"}},[s._v("#")]),s._v(" 7.2 表相关")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建表格")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\tid "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("not")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("auto_increment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    name "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("varchar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("255")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("not")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    email "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("varchar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("255")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("enable")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("tinyint")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("primary")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("engine")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("InnoDB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新增列")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("add")]),s._v(" age "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除列")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("drop")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("column")]),s._v(" age"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重命名表")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rename")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("旧表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("新表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除表")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("drop")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h3",{attrs:{id:"_7-3-用户权限相关"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-用户权限相关"}},[s._v("#")]),s._v(" 7.3 用户权限相关")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 切换到mysql数据库")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看所有用户")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新建用户")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test'")]),s._v(" identified "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'password'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 绑定主机")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# create user 'test'@`localhost` identified by 'password';")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重命名用户")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rename")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("test2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改密码")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" root identified "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改当前用户密码")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" password "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改其他密码")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" password "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" test2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'password'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看权限")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" grants "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("test2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认有个usage权限，其实就是无权限")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 赋予全数据表查询权限")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("grant")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" learningmysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" test2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 撤销权限")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("revoke")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" learningmysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" test2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除用户")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("drop")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test2'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 更多参考：https://dev.mysql.com/doc/refman/8.0/en/grant.html")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br")])]),t("h3",{attrs:{id:"_7-4-字符集相关"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-4-字符集相关"}},[s._v("#")]),s._v(" 7.4 字符集相关")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看字符集")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("character")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看校对顺序")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" collation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])])}),[],!1,null,null,null);t.default=n.exports}}]);